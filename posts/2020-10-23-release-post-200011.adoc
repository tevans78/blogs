---
layout: post
title: "Kerberos authentication and improved Grafana dashboard support now available with OpenLiberty 20.0.0.11"
categories: blog
author_picture: https://avatars3.githubusercontent.com/austin0
author_github: https://github.com/austin0
seo-title: Kerberos authentication and improved Grafana dashboard support now available with OpenLiberty 20.0.0.11 - OpenLiberty.io
seo-description: OpenLiberty 20.0.0.11 allows developers to use Kerberos authentication to secure their JDBC data sources inside Open Liberty projects. The 20.0.0.11 update also includes improved Grafana dashboard support on OpenLiberty.
blog_description: OpenLiberty 20.0.0.11 allows developers to use Kerberos authentication to secure their JDBC data sources, also included is improved support for MicroProfile Metrics visualization on Grafana dashboards.
open-graph-image: https://openliberty.io/img/blog/grafana.png
---
= Kerberos authentication and improved Grafana dashboard support now available with OpenLiberty 20.0.0.11
Austin Bailey <https://github.com/austin0>
:imagesdir: /
:url-prefix:
:url-about: /

// tag::intro[]

With Open Liberty 20.0.0.11 you can now make use of the Kerberos authentication protocol to secure your JDBC data sources. The Open Liberty Grafana dashboard has also been updated to be able to visualize MicroProfile Metrics data from Thanos data sources.

In link:{url-about}[Open Liberty] 20.0.0.11:

* <<kerberos, Kerberos authentication for JDBC data sources>>
* <<grafana, Grafana dashboard support for Thanos data source>>

View the list of fixed bugs in link:https://github.com/OpenLiberty/open-liberty/issues?q=label%3Arelease%3A200011+label%3A%22release+bug%22+[20.0.0.11].
// end::intro[]

// tag::run[]
[#run]

== Run your apps using 20.0.0.11

If you're using link:{url-prefix}/guides/maven-intro.html[Maven], here are the coordinates:

[source,xml]
----
<dependency>
    <groupId>io.openliberty</groupId>
    <artifactId>openliberty-runtime</artifactId>
    <version>20.0.0.11</version>
    <type>zip</type>
</dependency>
----

Or for link:{url-prefix}/guides/gradle-intro.html[Gradle]:

[source,gradle]
----
dependencies {
    libertyRuntime group: 'io.openliberty', name: 'openliberty-runtime', version: '[20.0.0.11,)'
}
----

Or if you're using Docker:

[source]
----
FROM open-liberty
----
//end::run[]

Or take a look at our link:{url-prefix}/downloads/[Downloads page].

[link=https://stackoverflow.com/tags/open-liberty]
image::img/blog/blog_btn_stack.svg[Ask a question on Stack Overflow, align="center"]

//tag::features[]

[#kerberos]
=== Kerberos authentication for JDBC data sources

Kerberos is a network authentication protocol in which a client and server authenticate by communicating with a third process called a Key Distribution Center (KDC). Kerberos authentication may be used for JDBC data sources that are backed by one of the following databases:

* IBM DB2
* Oracle Database
* Microsoft SQLServer
* PostgreSQL

Kerberos authentication in Liberty builds on top of the link:https://docs.oracle.com/en/java/javase/11/docs/api/jdk.security.auth/com/sun/security/auth/module/Krb5LoginModule.html[Kerberos Login Module and JGSS API provided by the JDK], which in turn builds on top of the Kerberos OS libraries for the specific system being used.

The `kerberos` configuration element in `server.xml` provides system-wide configuration options for the Liberty server. For example:

[source, xml]
----
  <kerberos keytab="${server.config.dir}/security/krb5.keytab" configFile="${server.config.dir}/security/krb5.conf"/>
----

Below is an example of the Kerberos protocol being used to secure a data source: 

[source, xml]
----
  <featureManager>
    <feature>jdbc-4.2</feature>
  </featureManager>

  <!-- optional config: This is only needed if you need to customize the location of keytab or krb5.conf -->
  <kerberos keytab="${server.config.dir}/security/krb5.keytab" configFile="${server.config.dir}/security/krb5.conf"/>

  <authData id="myKerberosAuth" krb5Principal="krbUser"/>

  <library id="db2DriverLib">
    <fileset dir="${server.config.dir}/db2"/>
  </library>

  <dataSource jndiName="jdbc/krb/basic" containerAuthDataRef="myKerberosAuth">
    <jdbcDriver libraryRef="db2DriverLib"/>
    <properties.db2.jcc databaseName="${DB2_DBNAME}" serverName="${DB2_HOSTNAME}" portNumber="${DB2_PORT}"/>
  </dataSource>
----

Before this release, it was technically possible to use Kerberos authentication with JDBC data sources, but the configuration was complex and un-documented. Also, was a lack of connection pooling support when using Kerberos authentication for data sources.

////
Full documentation for this capability will be available soon in the link:{url-prefix}/docs/latest/overview.html[Open Liberty documentation] pages.
////

[#grafana]
== Grafana dashboard support for Thanos data source

With Open Liberty 20.0.0.11 the Open Liberty Grafana dashboard, which visualizes data from the MicroProfile Metrics feature, is now able to visualize data from a Thanos data source.

The Grafana dashboard provides a wide range of time-series visualizations of MicroProfile Metrics data such as CPU, Servlet, Connection Pool, and Garbage Collection metrics. It is powered by a Prometheus data source which is configured to ingest data from the `/metrics` endpoint of one or more Liberty servers, enabling you to view performance metrics in near real-time.

Previously, support has only been provided for visualizing metrics data with Grafana on Open Liberty servers that used Prometheus as the data source. In Kubernetes environments, such as the Red Hat OpenShift Container Platform, you can use Thanos to query and store metrics data from multiple clusters. The previous Grafana Dashboards would not work when Thanos was set as the data source, whereas the new Grafana dashboard allows users using Thanos as the data source to display metrics data.

[.img_border_dark]
image::img/blog/grafana.png[align="center",Image of the updated Grafana dashboard from 20.0.0.11.]

For more information:

link:https://github.com/OpenLiberty/open-liberty-operator/tree/master/deploy/dashboards/metrics/[Open Liberty Grafana dashboards]

link:https://prometheus.io/docs/prometheus/latest/querying/basics/[Creating your own custom visualizations with Prometheus]

link:https://www.openshift.com/blog/federated-prometheus-with-thanos-receive[Thanos in Red Hat OpenShift Container Platform]

//end::features[]

== Get Open Liberty 20.0.0.11 now

Available through <<run,Maven, Gradle, Docker, and as a downloadable archive>>.
